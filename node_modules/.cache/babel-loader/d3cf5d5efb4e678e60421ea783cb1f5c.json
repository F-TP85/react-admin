{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/checkbox/style\";\nimport _Checkbox from \"antd/es/checkbox\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"D:\\\\Visual Studio Code\\\\B\\u7AD9\\u5B66\\u4E60\\\\react\\\\project\\\\react-admin\\\\src\\\\pages\\\\login\\\\index.jsx\";\nimport React, { Component } from \"react\";\nimport \"./index.css\";\nimport { Header } from \"antd/lib/layout/layout\";\nimport p1 from \"../../assets/img/logo.png\";\nimport { reqLogin } from '../../api/index';\nexport default class Login extends Component {\n  constructor(...args) {\n    super(...args);\n    this.formRef = /*#__PURE__*/React.createRef();\n    this.state = {\n      loading: false\n    };\n    this.layout = {\n      labelCol: {\n        span: 8\n      },\n      wrapperCol: {\n        span: 16\n      }\n    };\n    this.tailLayout = {\n      wrapperCol: {\n        offset: 8,\n        span: 16\n      }\n    };\n\n    this.onFinish = async values => {\n      this.setState({\n        loading: true\n      });\n      let res = await reqLogin({\n        username: values.username,\n        password: values.password\n      });\n      this.setState({\n        loading: false\n      });\n\n      if (res ? res.status === 200 : false) {\n        if (res.data.status) return _message.error(res.data.msg);\n\n        _message.success('登录成功!'); //注意: 这里的pathname是不驼峰命名\n\n\n        this.props.history.replace({\n          pathname: '/admin',\n          state: {\n            usename\n          }\n        });\n      }\n    };\n\n    this.onFinishFailed = errorInfo => {\n      console.log(\"Failed:\", errorInfo);\n    };\n\n    this.onReset = () => {\n      this.formRef.current.resetFields();\n    };\n\n    this.usernameRules = [{\n      required: true,\n      whitespace: true,\n      message: \"请输入账户名!\"\n    }, {\n      min: 4,\n      message: \"用户名最少4位\"\n    }, {\n      max: 12,\n      message: \"用户名最多12位\"\n    }, {\n      pattern: /^[a-zA-Z0-9_-]+$/,\n      message: \"用户名只能由数字/字母/下划线组成\"\n    }];\n    this.passwordRules = [{\n      validator: (_, value) => {\n        if (value ? value.length >= 4 && value.length <= 12 : false) {\n          return Promise.resolve();\n        } else {\n          return Promise.reject('密码长度必须是4~12位');\n        }\n      }\n    }, {\n      validator: (_, value, callback) => {\n        let rules_ = /^[a-zA-Z0-9_-]+$/;\n\n        if (rules_.test(value)) {\n          // callback();//验证通过时调用\n          return Promise.resolve();\n        } else {\n          //callback(\"密码必须有数字、字母、下划线组成\")\n          return Promise.reject('密码长度必须是4~12位');\n        }\n      }\n    }];\n  }\n\n  componentDidMount() {\n    //挂载时 可以获取ref 这里就可以设置默认值\n    this.formRef.current.setFieldsValue({\n      username: \"admin\" // password: \"1234\"\n\n    }); //console.log(this.formRef.current.getFieldValue())//这里能够获取到初始化挂载的值\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        className: \"header\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: p1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"React-\\u540E\\u53F0\\u7BA1\\u7406\\u7CFB\\u7EDF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(_Space, {\n        size: \"middle\",\n        className: this.state.loading ? 'loading' : 'loading_none',\n        children: /*#__PURE__*/_jsxDEV(_Spin, {\n          size: \"large\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login_content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"login_\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u7528\\u6237\\u767B\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(_Form, { ...this.layout,\n            name: \"basic\",\n            initialValues: {\n              remember: true\n            },\n            onFinish: this.onFinish,\n            onFinishFailed: this.onFinishFailed,\n            ref: this.formRef,\n            children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n              label: \"Username\",\n              name: \"username\",\n              rules: this.usernameRules,\n              children: /*#__PURE__*/_jsxDEV(_Input, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n              label: \"Password\",\n              name: \"password\",\n              rules: this.passwordRules,\n              children: /*#__PURE__*/_jsxDEV(_Input.Password, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(_Form.Item, { ...this.tailLayout,\n              name: \"remember\",\n              valuePropName: \"checked\",\n              children: /*#__PURE__*/_jsxDEV(_Checkbox, {\n                children: \"Remember me\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(_Form.Item, { ...this.tailLayout,\n              children: [/*#__PURE__*/_jsxDEV(_Button, {\n                type: \"primary\",\n                htmlType: \"submit\",\n                children: \"\\u767B\\u5F55\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(_Button, {\n                htmlType: \"button\",\n                onClick: this.onReset,\n                children: \"Reset\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["D:/Visual Studio Code/B站学习/react/project/react-admin/src/pages/login/index.jsx"],"names":["React","Component","Header","p1","reqLogin","Login","formRef","createRef","state","loading","layout","labelCol","span","wrapperCol","tailLayout","offset","onFinish","values","setState","res","username","password","status","data","error","msg","success","props","history","replace","pathname","usename","onFinishFailed","errorInfo","console","log","onReset","current","resetFields","usernameRules","required","whitespace","message","min","max","pattern","passwordRules","validator","_","value","length","Promise","resolve","reject","callback","rules_","test","componentDidMount","setFieldsValue","render","remember"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./index.css\";\r\nimport { Header } from \"antd/lib/layout/layout\";\r\nimport p1 from \"../../assets/img/logo.png\";\r\nimport { Form, Input, Button, Checkbox, Spin, Space, message } from \"antd\";\r\nimport { reqLogin } from '../../api/index'\r\n\r\nexport default class Login extends Component {\r\n  //ref注册表单 用于重置表单\r\n  formRef = React.createRef();\r\n\r\n  state = {\r\n    loading: false\r\n  }\r\n\r\n  layout = {\r\n    labelCol: { span: 8 },\r\n    wrapperCol: { span: 16 },\r\n  };\r\n\r\n  tailLayout = {\r\n    wrapperCol: { offset: 8, span: 16 },\r\n  };\r\n\r\n  //表单验证成功的回调 成功后登录\r\n  onFinish = async (values) => {\r\n    this.setState({loading:true})\r\n\r\n    let res = await reqLogin({\r\n      username:values.username,\r\n      password:values.password\r\n    })\r\n\r\n    this.setState({loading:false})\r\n\r\n    if(res?res.status === 200:false){\r\n\r\n      if(res.data.status) return message.error(res.data.msg)\r\n      \r\n      message.success('登录成功!')\r\n      //注意: 这里的pathname是不驼峰命名\r\n      this.props.history.replace({pathname:'/admin',state:{usename}})\r\n      \r\n    }\r\n  };\r\n\r\n  //表单验证失败的回调\r\n  onFinishFailed = (errorInfo) => {\r\n    console.log(\"Failed:\", errorInfo);\r\n  };\r\n\r\n  //重置\r\n  onReset = () => {\r\n    this.formRef.current.resetFields();\r\n  };\r\n\r\n  //验证规则 分多个子项来写可以做到边输入边验证\r\n  //1.声明式表单验证：\r\n  usernameRules = [\r\n    { required: true, whitespace: true, message: \"请输入账户名!\" },\r\n    {min: 4,message: \"用户名最少4位\"},\r\n    {max: 12, message: \"用户名最多12位\"},\r\n    {pattern: /^[a-zA-Z0-9_-]+$/,message: \"用户名只能由数字/字母/下划线组成\"}\r\n  ]\r\n\r\n  //2. validator自定义式验证：\r\n  passwordRules = [\r\n    {\r\n        validator: (_, value) =>{\r\n          if(value?value.length >= 4 && value.length<=12:false) {\r\n              return Promise.resolve()\r\n          }else{\r\n              return Promise.reject('密码长度必须是4~12位')\r\n          }\r\n        }\r\n    },{\r\n      validator: (_,value,callback) => {\r\n        let rules_ = /^[a-zA-Z0-9_-]+$/\r\n        if(rules_.test(value)){\r\n          // callback();//验证通过时调用\r\n          return Promise.resolve()\r\n        } else {\r\n          //callback(\"密码必须有数字、字母、下划线组成\")\r\n          return Promise.reject('密码长度必须是4~12位')\r\n        }\r\n      }\r\n    }\r\n  ]\r\n\r\n  componentDidMount(){\r\n    //挂载时 可以获取ref 这里就可以设置默认值\r\n    this.formRef.current.setFieldsValue({\r\n      username: \"admin\",\r\n      // password: \"1234\"\r\n    })\r\n    //console.log(this.formRef.current.getFieldValue())//这里能够获取到初始化挂载的值\r\n    \r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"login\">\r\n        <Header className=\"header\">\r\n          <img src={p1} />\r\n          <h1>React-后台管理系统</h1>\r\n        </Header>\r\n\r\n        <Space size=\"middle\" className={this.state.loading?'loading':'loading_none'}>\r\n          <Spin size=\"large\" />\r\n        </Space>\r\n\r\n        <div className=\"login_content\">\r\n          <div className=\"login_\">\r\n            <h2>用户登录</h2>\r\n\r\n            <Form {...this.layout} name=\"basic\" initialValues={{ remember: true }} onFinish={this.onFinish} onFinishFailed={this.onFinishFailed} ref={this.formRef}>\r\n              <Form.Item label=\"Username\" name=\"username\" rules={this.usernameRules}>\r\n                <Input />\r\n              </Form.Item>\r\n\r\n              <Form.Item label=\"Password\" name=\"password\" rules={this.passwordRules}>\r\n                <Input.Password />\r\n              </Form.Item>\r\n\r\n              <Form.Item {...this.tailLayout} name=\"remember\" valuePropName=\"checked\">\r\n                <Checkbox>Remember me</Checkbox>\r\n              </Form.Item>\r\n\r\n              <Form.Item {...this.tailLayout}>\r\n                <Button type=\"primary\" htmlType=\"submit\">登录</Button>\r\n                <Button htmlType=\"button\" onClick={this.onReset}>Reset</Button>\r\n              </Form.Item>\r\n            </Form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}